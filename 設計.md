# テーブル

## 書籍

* 書籍ID 数値　主キー out increment
* タイトル 可変文字列 100文字
* 価格 数値　0以上
* 出版状況 固定文字(1) '0': 未出版, '1': 出版済
* 更新日時 yyyymmddhhmmss
* 登録日時 yyyymmddhhmmss

## 著者

* 著者ID 主キー 数値　主キー out increment
* 名前  可変文字列 100文字
* 生年月日 yyyymmdd
* 更新日時 yyyymmddhhmmss
* 登録日時 yyyymmddhhmmss

## 書籍著者

* 著者ID 主キー
* 書籍ID 主キー
 
# API仕様

* /list
  * dbに登録されている著者と書籍の情報のリスト取得 
  * get
  * パラメータ（クエリ）
    * limit default 0
    * offset  default 10
  * return
    * 著者ID
    * 名前
    * 生年月日
    * 書籍ID
    * タイトル
    * 価格
    * 出版状況
  * ソート順
    * 著者ID
    * 書籍ID
* author/${著者ID}
  * get
  * パラメータ（パス）
    * 著者IDs[]
  * return
    * 著者
      * 著者ID
      * 名前
      * 生年月日
      * 書籍[]
        * タイトル
        * 価格
        * 出版状況
* author
  * post (登録) , patch（更新）
  * パラメータ(クエリ)
    * 著者ID (Nullであれば新規登録)
  * パラメータ(本文)
    * 名前 （未設定の場合更新なし・登録の場合必須入力）
    * 生年月日 （未設定の場合更新なし・登録の場合必須入力）

  
* book
  * post (登録) patch（更新）
  * パラメータ(クエリ)
    * id (DBに存在しなければ新規登録)
  * パラメータ(本文)
    * タイトル （未設定の場合更新なし・登録の場合必須入力）
    * 価格 （未設定の場合更新なし・登録の場合必須入力）
    * 出版状況 （未設定の場合更新なし・登録の場合必須入力）
    * 著者ID （未設定の場合更新なし・登録の場合必須入力）
  * チェック
    * 出版状況が出版済みの時に未出版に更新しようとしたらエラー
* レスポンスコードについて
  * 正常終了: 200 
  * システムエラー: 500
  * パラメータ不備: 400
  * データが存在しない: 404

# postgresql

##  ログイン

* $ docker exec -it codingtest-postgres-1 bash
* $ psql -h localhost -U testuser -d codingtestdb

## テーブル一覧表示

* $ \dt


## jooq

* $ ./gradlew :jooqCodegen


# クエリ

## 著者登録

curl -X POST -H "Content-Type: application/json" http://localhost:8080/api/author -d '{"id": "3","name":"namename","birthday":"111128222"}'
curl -X PATCH -H "Content-Type: application/json" http://localhost:8080/api/author -d '{"id": "1","name":"俺","birthday":"99991231"}'

curl -X POST -H "Content-Type: application/json" http://localhost:8080/api/book  -d '{"title": "赤丸ジャンプ", "price": 240, "publish": "0", "authorIds": [1,2]}'
curl -X PATCH -H "Content-Type: application/json" http://localhost:8080/api/book -d '{"id": 33,"title":"赤丸ジャンプ15","price": 240, "publish": "0", "authorIds": [1,2]}'
